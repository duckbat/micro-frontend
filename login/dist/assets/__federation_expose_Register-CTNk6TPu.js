import{importShared as h}from"./__federation_fn_import-CrsKBspk.js";import{j as e}from"./jsx-runtime-BQMR-BYT.js";import{u as b,a as U,b as C,L as c,I as m,c as N,B as A}from"./formHooks-CRDPOViZ.js";const d=async(n,i={})=>{console.log("fetching data from url: ",n);const s=await fetch(n,i),r=await s.json();if(!s.ok){const a=r;throw console.log("errorJson",a),a.message?new Error(a.message):new Error(`Error ${s.status} occured`)}return r};await h("react");const E=()=>({getUserByToken:async a=>{const t={headers:{Authorization:"Bearer "+a}};return await d("https://media2.edu.metropolia.fi/gateway/auth-api/api/v1/users/token/",t)},postUser:async a=>{const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)};await d("https://media2.edu.metropolia.fi/gateway/auth-api/api/v1/users",t)},getUsernameAvailable:async a=>await d("https://media2.edu.metropolia.fi/gateway/auth-api/api/v1/users/username/"+a),getEmailAvailable:async a=>await d("https://media2.edu.metropolia.fi/gateway/auth-api/api/v1/users/email/"+a)}),{useState:p}=await h("react"),k=()=>{const{postUser:n,getUsernameAvailable:i,getEmailAvailable:s}=E(),[r,a]=p(!0),[t,x]=p(!0),g={username:"",password:"",email:"",confirm:""},w=async()=>{if(r&&t)try{await n(j)}catch(o){console.error(o.message)}},{handleSubmit:y,handleInputChange:l,inputs:j}=b(w,g),f=async o=>{const u=await i(o.currentTarget.value);a(u.available)},v=async o=>{const u=await s(o.currentTarget.value);x(u.available)};return e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"text-center",children:e.jsx("h2",{className:"text-2xl font-bold",children:"Register"})}),e.jsxs(C,{className:"space-y-4 px-6 py-8",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"username",children:"Username"}),e.jsx(m,{id:"username",name:"username",type:"text",placeholder:"Username",required:!0,onBlur:f,onChange:l}),!r&&e.jsx("p",{className:"text-red-600",children:"Username not available"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"email",children:"Email"}),e.jsx(m,{id:"email",name:"email",type:"email",placeholder:"m@example.com",required:!0,onBlur:v,onChange:l}),!t&&e.jsx("p",{className:"text-red-600",children:"Email not available"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"password",children:"Password"}),e.jsx(m,{id:"password",name:"password",type:"password",required:!0,onChange:l})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(m,{id:"confirmPassword",name:"confirm",type:"password",required:!0,onChange:l})]})]}),e.jsx(N,{className:"px-6 pb-6",children:e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(A,{onClick:y,children:"Register"})})})]})};export{k as default};
